Using cuda device
Shape of X [B, C, H, W]: torch.Size([8, 3, 256, 256])
Shape of y: torch.Size([8]) torch.int64
NeuralNetwork(
  (conv_stack): Sequential(
    (0): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
    (1): LayerNorm((128, 64, 64), eps=1e-05, elementwise_affine=True)
    (2): Conv2d(128, 128, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3))
    (3): LayerNorm((128, 64, 64), eps=1e-05, elementwise_affine=True)
    (4): Flatten(start_dim=1, end_dim=-1)
    (5): Linear(in_features=524288, out_features=256, bias=True)
    (6): GELU(approximate='none')
    (7): Linear(in_features=256, out_features=524288, bias=True)
    (8): Unflatten(dim=1, unflattened_size=(128, 64, 64))
    (9): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (10): Flatten(start_dim=1, end_dim=-1)
    (11): Linear(in_features=131072, out_features=3, bias=True)
  )
)

Epoch 1
-------------------------------
Train batch avg loss = 1.077998  [    8/  451]
Train batch avg loss =     nan  [   88/  451]
Train batch avg loss =     nan  [  168/  451]
Train batch avg loss =     nan  [  248/  451]
Train batch avg loss =     nan  [  328/  451]
Train batch avg loss =     nan  [  408/  451]
Train Loss: nan, Validation Loss: nan, Validation Accuracy: 41.24%

Epoch 2
-------------------------------
Train batch avg loss =     nan  [  459/  451]
Train batch avg loss =     nan  [  539/  451]
Train batch avg loss =     nan  [  619/  451]
Train batch avg loss =     nan  [  699/  451]
Train batch avg loss =     nan  [  779/  451]
Train batch avg loss =     nan  [  859/  451]
Train Loss: nan, Validation Loss: nan, Validation Accuracy: 41.24%

Epoch 3
-------------------------------
Train batch avg loss =     nan  [  910/  451]
Train batch avg loss =     nan  [  990/  451]
Train batch avg loss =     nan  [ 1070/  451]
Train batch avg loss =     nan  [ 1150/  451]
Train batch avg loss =     nan  [ 1230/  451]
Train batch avg loss =     nan  [ 1310/  451]
Train Loss: nan, Validation Loss: nan, Validation Accuracy: 41.24%

Epoch 4
-------------------------------
Train batch avg loss =     nan  [ 1361/  451]
Train batch avg loss =     nan  [ 1441/  451]
Train batch avg loss =     nan  [ 1521/  451]
Train batch avg loss =     nan  [ 1601/  451]
Train batch avg loss =     nan  [ 1681/  451]
Train batch avg loss =     nan  [ 1761/  451]
Train Loss: nan, Validation Loss: nan, Validation Accuracy: 41.24%

Epoch 5
-------------------------------
Train batch avg loss =     nan  [ 1812/  451]
Train batch avg loss =     nan  [ 1892/  451]
Train batch avg loss =     nan  [ 1972/  451]
Train batch avg loss =     nan  [ 2052/  451]
Train batch avg loss =     nan  [ 2132/  451]
Train batch avg loss =     nan  [ 2212/  451]
Train Loss: nan, Validation Loss: nan, Validation Accuracy: 41.24%
Done!
Saved PyTorch Model State to model.pth
