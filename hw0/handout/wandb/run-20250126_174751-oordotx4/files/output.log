Using cuda device
Shape of X [B, C, H, W]: torch.Size([8, 3, 256, 256])
Shape of y: torch.Size([8]) torch.int64
NeuralNetwork(
  (conv_stack): Sequential(
    (0): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
    (1): LayerNorm((128, 64, 64), eps=1e-05, elementwise_affine=True)
    (2): Conv2d(128, 128, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3))
    (3): LayerNorm((128, 64, 64), eps=1e-05, elementwise_affine=True)
    (4): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (5): Flatten(start_dim=1, end_dim=-1)
  )
  (fc_stack): Sequential(
    (0): Linear(in_features=131072, out_features=256, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=256, out_features=128, bias=True)
    (3): Linear(in_features=128, out_features=3, bias=True)
  )
)

Epoch 1
-------------------------------
Train batch avg loss = 1.075629  [    8/  451]
Train batch avg loss = 1.529351  [   88/  451]
Train batch avg loss = 1.020273  [  168/  451]
Train batch avg loss = 0.901732  [  248/  451]
Train batch avg loss = 1.374728  [  328/  451]
Train batch avg loss = 0.730357  [  408/  451]
Train Loss: 1.008546, Validation Loss: 0.749307, Validation Accuracy: 67.01%

Epoch 2
-------------------------------
Train batch avg loss = 0.336490  [  459/  451]
Train batch avg loss = 1.064050  [  539/  451]
Train batch avg loss = 0.505974  [  619/  451]
Train batch avg loss = 0.614155  [  699/  451]
Train batch avg loss = 0.914095  [  779/  451]
Train batch avg loss = 0.459379  [  859/  451]
Train Loss: 0.520496, Validation Loss: 0.843818, Validation Accuracy: 65.98%

Epoch 3
-------------------------------
Train batch avg loss = 0.048849  [  910/  451]
Train batch avg loss = 0.621608  [  990/  451]
Train batch avg loss = 0.315210  [ 1070/  451]
Train batch avg loss = 0.376360  [ 1150/  451]
Train batch avg loss = 0.370885  [ 1230/  451]
Train batch avg loss = 0.054408  [ 1310/  451]
Train Loss: 0.228484, Validation Loss: 0.987982, Validation Accuracy: 67.01%

Epoch 4
-------------------------------
Train batch avg loss = 0.028903  [ 1361/  451]
Train batch avg loss = 0.120027  [ 1441/  451]
Train batch avg loss = 0.086737  [ 1521/  451]
Train batch avg loss = 0.045505  [ 1601/  451]
Train batch avg loss = 0.100758  [ 1681/  451]
Train batch avg loss = 0.032108  [ 1761/  451]
Train Loss: 0.089639, Validation Loss: 1.054803, Validation Accuracy: 65.98%

Epoch 5
-------------------------------
Train batch avg loss = 0.029978  [ 1812/  451]
Train batch avg loss = 0.061480  [ 1892/  451]
Train batch avg loss = 0.034105  [ 1972/  451]
Train batch avg loss = 0.014884  [ 2052/  451]
Train batch avg loss = 0.045548  [ 2132/  451]
Train batch avg loss = 0.005293  [ 2212/  451]
Train Loss: 0.054592, Validation Loss: 1.141156, Validation Accuracy: 69.07%
Done!
Saved PyTorch Model State to model.pth
